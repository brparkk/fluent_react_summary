# CHAPTER 03. 가상 DOM

## 목차

1. [DOM이란 무엇이며, 가상 DOM과 어떻게 다른가요](#1-dom이란-무엇이며-가상-dom과-어떻게-다른가요)
2. [문서 조각이란 무엇이며, 리액트의 가상 DOM과 어떤 점에서 비슷하고 다른가요?](#2-문서-조각이란-무엇이며-리액트의-가상-dom과-어떤-점에서-비슷하고-다른가요)
3. [DOM에서 문제가 되는 사안은 무엇인가요?](#3-dom에서-문제가-되는-사안은-무엇인가요)
4. [사용자 인터페이스를 더 빠르게 업데이트하는데 가상 DOM이 어떻게 활용되나요?](#4-사용자-인터페이스를-더-빠르게-업데이트하는데-가상-dom이-어떻게-활용되나요)
5. [리액트의 렌더링은 어떻게 작동하나요? 이로 인해 잠재되었던 어떤 문제가 발생할 수 있나요?](#5-리액트의-렌더링은-어떻게-작동하나요-이로-인해-잠재되었던-어떤-문제가-발생할-수-있나요)

## 1. DOM이란 무엇이며, 가상 DOM과 어떻게 다른가요?

📌 DOM
- 브라우저 런타임의 문서 모델을 의미한다. 노드 객체가 계층적으로 표현된 방식이다.
- 각 HTML에 엘리먼트에 해당하는 노드를 트리 같은 구조로 구성해 표현한 방식이다.
- 트리의 각 노드는 HTML 엘리먼트를 의미하며, 속성과 메서드가 포함되어 있다.

📌 가상 DOM
- HTML 문서를 자바스크립트 객체로 모델링 한 것이다.
- 앞서 1장에서 리액트가 나온 배경을 설명할 때, 실제 DOM 조작이 성능에 어떤 영향을 끼칠 수 있는지 알아봤었다.
- 실제 DOM이 변경되면 브라우저는 그때마다 <u>레이아웃을 다시 계산해서 화면을 그려야 하는데</u> 이 시간이 오래 걸릴 수 있다.

엘리먼트의 `offsetWidth`를 읽기만 해도 브라우저가 문서 전체나 일부 레이아웃을 다시 계산하는 과정을 거치게 되는데, 이를 <span style="color: skyblue; font-weight: bold;">Reflow</span> 라고 한다.
리플로우는 성능에 직접적인 영향을 끼칠 뿐 아니라 DOM과의 상호작용에도 영향을 끼칠 수 있다.

**가상 DOM**을 사용하게 되면 변경사항이 바로 반영되지 않고, 이전 버전과 새 버전의 차이점을 먼저 식별한다. 그 후 실제 DOM 업데이트에 필요한 최소한의 변경 사항을 최적화된 방식(재조정)으로 업데이트 한다.

**가상 DOM** 업데이트는 실제 페이지 레이아웃을 변경하지 않기 때문에 훨씬 빠르게 동작한다.

또한 **가상 DOM**은 평범한 자바스크립트 객체로 구성되기 때문에 환경에 얽매이지 않고 자바스크립트 엔진을 최대한 활용할 수 있는 이점이 있다.

## 2. 문서 조각이란 무엇이며, 리액트의 가상 DOM과 어떤 점에서 비슷하고 다른가요?



## 3. DOM에서 문제가 되는 사안은 무엇인가요?

🐛 1. `document.querySelector`

> `document.querySelector` 메서드는 CSS 선택자를 기반으로 DOM의 엘리먼트 요소를 가지고 오는 메서드이다.
>  - 이 메서드는 문서의 길이가 길 경우, 성능에 심각한 문제를 초래할 수도 있다.

이 메서드의 동작 방식을 간략하게 살펴보면,

1️⃣ CSS 선택자를 전달해 `document.querySelector`를 호출한다.

2️⃣ 브라우저는 전체 문서 트리에서 일치하는 엘리먼트를 찾는다. (문서 상단 → 하단)
* CSS의 복잡도에 따라 탐색 과정이 복잡해진다.
* 문서가 크거나 문서의 구조가 복잡한 경우 탐색 시간이 증가한다.

😢 최악의 시나리오인 경우 시간 복잡도 : `O(N)`

#### 👀 대안으로 `getElementById` ?!

아이디로 검색하게 되면 성능이 상당히 개선된다.
그렇지만 id는 고유 식별자로 약속된 것일 뿐, 브라우저에서 강제하지 않는다.
충돌 가능성이 언제나 있기 마련이다.

또한 여러 곳에서 컴포넌트로 사용하려면 `id` 를 식별자로 사용하는 것은 적합하지 않을 수 있다.

🎲 시간 복잡도 : `O(1)`

## 4. 사용자 인터페이스를 더 빠르게 업데이트하는데 가상 DOM이 어떻게 활용되나요?


## 5. 리액트의 렌더링은 어떻게 작동하나요? 이로 인해 잠재되었던 어떤 문제가 발생할 수 있나요?